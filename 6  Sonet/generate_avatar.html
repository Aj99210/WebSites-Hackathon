<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avatar Generator for Sonet</title>
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --accent: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #38b000;
            --border-radius: 12px;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--dark);
            user-select: none;
        }
        
        .container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 900px;
            padding: 2.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        header {
            text-align: center;
            margin-bottom: 2rem;
            width: 100%;
            border-bottom: 1px solid #eee;
            padding-bottom: 1rem;
        }
        
        h1 {
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-weight: 600;
            letter-spacing: -0.5px;
            position: relative;
            user-select: none;
            display: inline-block;
        }
        
        h1::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 25%;
            width: 50%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
            border-radius: 3px;
        }
        
        .tagline {
            color: #666;
            font-size: 1rem;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
        
        @media (min-width: 768px) {
            .main-content {
                flex-direction: row;
                align-items: flex-start;
                gap: 2rem;
            }
        }
        
        .preview-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        @media (min-width: 768px) {
            .preview-section {
                flex: 1;
                margin-bottom: 0;
            }
        }
        
        .controls-section {
            display: flex;
            flex-direction: column;
            width: 100%;
        }
        
        @media (min-width: 768px) {
            .controls-section {
                flex: 1;
            }
        }
        
        .canvas-container {
            position: relative;
            margin-bottom: 1.5rem;
        }
        
        canvas {
            display: block;
            border-radius: 50%;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            background-color: #f8f9fa;
            position: relative;
            z-index: 5;
        }
        
        .canvas-container::after {
            content: '';
            position: absolute;
            width: 220px;
            height: 220px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            top: 15px;
            left: 15px;
            z-index: 1;
            opacity: 0.18;
            filter: blur(12px);
            transition: opacity 0.3s ease, filter 0.3s ease;
        }
        
        .canvas-container:hover::after {
            opacity: 0.22;
            filter: blur(14px);
        }
        
        canvas:hover {
            transform: scale(1.03);
            box-shadow: 0 10px 28px rgba(0, 0, 0, 0.18);
        }
        
        .canvas-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }
        
        .canvas-container:hover .canvas-overlay {
            opacity: 1;
        }
        
        .canvas-message {
            color: white;
            font-weight: 500;
            font-size: 0.9rem;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 8px 12px;
            border-radius: 4px;
        }
        
        .control-group {
            margin-bottom: 1.5rem;
            width: 100%;
        }
        
        .control-group:last-child {
            margin-bottom: 0;
        }
        
        .control-title {
            font-weight: 600;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            color: var(--primary-dark);
        }
        
        .control-title svg {
            margin-right: 0.5rem;
        }
        
        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .btn {
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.25s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.95rem;
        }
        
        .btn svg {
            margin-right: 0.5rem;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(67, 97, 238, 0.3);
        }
        
        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #5c0896;
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(114, 9, 183, 0.3);
        }
        
        .btn-accent {
            background-color: var(--accent);
            color: white;
        }
        
        .btn-accent:hover {
            background-color: #d91b6f;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(247, 37, 133, 0.4);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(67, 97, 238, 0.3);
            transform: translateY(-2px);
        }
        
        .slider-group {
            margin-bottom: 1rem;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        .slider {
            width: 100%;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 4px;
            background: #ddd;
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            transition: background 0.2s;
            border: none;
        }
        
        .slider::-webkit-slider-thumb:hover {
            background: var(--primary-dark);
        }
        
        .slider::-moz-range-thumb:hover {
            background: var(--primary-dark);
        }
        
        .color-options {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .color-option {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
            border: 2px solid transparent;
        }
        
        .color-option:hover {
            transform: scale(1.15);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .color-option.active {
            border-color: var(--dark);
            transform: scale(1.15);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.12);
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .checkbox-group input {
            margin-right: 0.5rem;
        }
        
        footer {
            margin-top: 2.5rem;
            text-align: center;
            width: 100%;
            border-top: 1px solid #eee;
            padding-top: 1.2rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        .dev-credit {
            font-weight: 500;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .dev-credit svg {
            color: var(--accent);
        }
        
        .toast {
            position: fixed;
            bottom: -60px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--success);
            color: white;
            padding: 0.85rem 1.6rem;
            border-radius: var(--border-radius);
            font-weight: 500;
            box-shadow: 0 4px 18px rgba(0, 0, 0, 0.25);
            display: flex;
            align-items: center;
            gap: 0.6rem;
            transition: bottom 0.3s ease, transform 0.2s ease;
            z-index: 1000;
        }
        
        .toast svg {
            margin-right: 0.5rem;
        }
        
        .toast.show {
            bottom: 30px;
            animation: toast-bounce 0.4s ease;
        }
        
        @keyframes toast-bounce {
            0% { transform: translateX(-50%) scale(0.9); }
            50% { transform: translateX(-50%) scale(1.05); }
            100% { transform: translateX(-50%) scale(1); }
        }
        
        .shape-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .shape-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.75rem 0.85rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.25s ease;
            border: 2px solid transparent;
        }
        
        .shape-option:hover {
            background-color: #f5f7fa;
            transform: translateY(-3px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        .shape-option.active {
            border-color: var(--primary);
            background-color: rgba(67, 97, 238, 0.1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            transform: translateY(-1px);
        }
        
        .shape-icon {
            width: 30px;
            height: 30px;
            margin-bottom: 0.5rem;
        }
        
        .shape-name {
            font-size: 0.8rem;
            text-align: center;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.06); }
            100% { transform: scale(1); }
        }
        
        @keyframes shadow-pulse {
            0% { box-shadow: 0 0 0 rgba(67, 97, 238, 0); }
            50% { box-shadow: 0 0 20px rgba(67, 97, 238, 0.6); }
            100% { box-shadow: 0 0 0 rgba(67, 97, 238, 0); }
        }
        
        .animate-generate {
            animation: pulse 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275), shadow-pulse 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Avatar Generator for Sonet</h1>
            <p class="tagline">Create unique, stylish avatars for your C++ GTKmm3 application</p>
        </header>
        
        <div class="main-content">
            <div class="preview-section">
                <div class="canvas-container">
                    <canvas id="avatar" width="250" height="250"></canvas>
                    <div class="canvas-overlay">
                        <div class="canvas-message">Click to regenerate</div>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button id="downloadBtn" class="btn btn-primary">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Download
                    </button>
                    <button id="copyBtn" class="btn btn-outline">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                        Copy to Clipboard
                    </button>
                </div>
            </div>
            
            <div class="controls-section">
                <div class="control-group">
                    <h3 class="control-title">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                        Generator Options
                    </h3>
                    <div class="btn-group">
                        <button id="generateBtn" class="btn btn-accent">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                <polyline points="7.5 4.21 12 6.81 16.5 4.21"></polyline>
                                <polyline points="7.5 19.79 7.5 14.6 3 12"></polyline>
                                <polyline points="21 12 16.5 14.6 16.5 19.79"></polyline>
                                <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                                <line x1="12" y1="22.08" x2="12" y2="12"></line>
                            </svg>
                            Generate New
                        </button>
                    </div>
                </div>
                
                <div class="control-group">
                    <h3 class="control-title">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                        </svg>
                        Shape Preferences
                    </h3>
                    <div class="shape-options">
                        <div class="shape-option active" data-shape="circle">
                            <svg class="shape-icon" viewBox="0 0 24 24" fill="currentColor">
                                <circle cx="12" cy="12" r="10" />
                            </svg>
                            <span class="shape-name">Circles</span>
                        </div>
                        <div class="shape-option" data-shape="square">
                            <svg class="shape-icon" viewBox="0 0 24 24" fill="currentColor">
                                <rect x="2" y="2" width="20" height="20" rx="2" />
                            </svg>
                            <span class="shape-name">Squares</span>
                        </div>
                        <div class="shape-option" data-shape="triangle">
                            <svg class="shape-icon" viewBox="0 0 24 24" fill="currentColor">
                                <polygon points="12,2 22,22 2,22" />
                            </svg>
                            <span class="shape-name">Triangles</span>
                        </div>
                        <div class="shape-option" data-shape="all">
                            <svg class="shape-icon" viewBox="0 0 24 24" fill="currentColor">
                                <circle cx="6" cy="6" r="4" />
                                <rect x="14" y="2" width="8" height="8" />
                                <polygon points="12,14 18,22 6,22" />
                            </svg>
                            <span class="shape-name">Mixed</span>
                        </div>
                        <div class="shape-option" data-shape="hexagon">
                            <svg class="shape-icon" viewBox="0 0 24 24" fill="currentColor">
                                <polygon points="12,2 21,7 21,17 12,22 3,17 3,7" />
                            </svg>
                            <span class="shape-name">Hexagon</span>
                        </div>
                        <div class="shape-option" data-shape="star">
                            <svg class="shape-icon" viewBox="0 0 24 24" fill="currentColor">
                                <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26" />
                            </svg>
                            <span class="shape-name">Star</span>
                        </div>
                    </div>
                    
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Number of Shapes</span>
                            <span id="shapeCountValue">5</span>
                        </div>
                        <input type="range" min="3" max="15" value="5" class="slider" id="shapeCountSlider">
                    </div>
                    
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Shape Size</span>
                            <span id="shapeSizeValue">Medium</span>
                        </div>
                        <input type="range" min="1" max="5" value="3" class="slider" id="shapeSizeSlider">
                    </div>
                </div>
                
                <div class="control-group">
                    <h3 class="control-title">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M8.56 2.75c4.37 6.03 6.02 9.42 8.03 17.72m2.54-15.38c-3.72 4.35-8.94 5.66-16.88 5.85m19.5 1.9c-3.5-.93-6.63-.82-8.94 0-2.58.92-5.01 2.86-7.44 6.32"></path>
                        </svg>
                        Color Theme
                    </h3>
                    <div class="color-options">
                        <div class="color-option active" style="background-color: #4361ee;" data-color="blue"></div>
                        <div class="color-option" style="background-color: #7209b7;" data-color="purple"></div>
                        <div class="color-option" style="background-color: #ff758f;" data-color="pink"></div>
                        <div class="color-option" style="background-color: #4cc9f0;" data-color="cyan"></div>
                        <div class="color-option" style="background-color: #38b000;" data-color="green"></div>
                        <div class="color-option" style="background-color: #fb5607;" data-color="orange"></div>
                        <div class="color-option" style="background-color: #ffbe0b;" data-color="yellow"></div>
                        <div class="color-option" style="background-color: #606c38;" data-color="olive"></div>
                        <div class="color-option" style="background-color: #ffd6e0;" data-color="pastel"></div>
                        <div class="color-option" style="background-color: #ff99c8;" data-color="kawaii"></div>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="randomColorsCheckbox" checked>
                        <label for="randomColorsCheckbox">Use random colors</label>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="borderCheckbox" checked>
                        <label for="borderCheckbox">Add white border</label>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Avatar Generator for Sonet | Made with ❤️ for GTKmm3</p>
            <div class="dev-credit">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                Developed By Ajay
            </div>
        </footer>
    </div>
    
    <div id="toast" class="toast">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <span id="toastMessage">Copied to clipboard!</span>
    </div>
    
    <script>
        // DOM Elements
        const canvas = document.getElementById('avatar');
        const ctx = canvas.getContext('2d');
        const downloadBtn = document.getElementById('downloadBtn');
        const copyBtn = document.getElementById('copyBtn');
        const generateBtn = document.getElementById('generateBtn');
        const shapeCountSlider = document.getElementById('shapeCountSlider');
        const shapeCountValue = document.getElementById('shapeCountValue');
        const shapeSizeSlider = document.getElementById('shapeSizeSlider');
        const shapeSizeValue = document.getElementById('shapeSizeValue');
        const randomColorsCheckbox = document.getElementById('randomColorsCheckbox');
        const borderCheckbox = document.getElementById('borderCheckbox');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        
        // Avatar configuration
        const config = {
            shapeType: 'all',
            shapeCount: 5,
            shapeSize: 3,
            colorTheme: 'blue',
            randomColors: true,
            border: true
        };
        
        // Color palettes
        const colorPalettes = {
            blue: ['#4361ee', '#3f37c9', '#4895ef', '#4cc9f0', '#560bad'],
            purple: ['#7209b7', '#560bad', '#480ca8', '#3f37c9', '#b5179e'],
            pink: ['#ff9fb6', '#ff8ba7', '#ff758f', '#ff6b83', '#ff4d6d'],
            cyan: ['#4cc9f0', '#4895ef', '#4361ee', '#48bfe3', '#56cfe1'],
            green: ['#38b000', '#70e000', '#9ef01a', '#ccff33', '#007200'],
            orange: ['#fb5607', '#ff6d00', '#ff8500', '#ff9e00', '#ffbf00'],
            yellow: ['#ffbe0b', '#ffd93d', '#ffd23f', '#fdca40', '#f7b801'],
            olive: ['#606c38', '#283618', '#dda15e', '#bc6c25', '#588157'],
            pastel: ['#ffd6e0', '#ffefeb', '#ffcfd2', '#f1c0e8', '#cfbaf0'],
            kawaii: ['#ff99c8', '#fcf6bd', '#d0f4de', '#a9def9', '#e4c1f9']
        };
        
        // Shape size names
        const shapeSizeNames = ['Tiny', 'Small', 'Medium', 'Large', 'Huge'];
        
        // Initialize shape options
        const shapeOptions = document.querySelectorAll('.shape-option');
        shapeOptions.forEach(option => {
            option.addEventListener('click', () => {
                shapeOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                config.shapeType = option.dataset.shape;
                drawAvatar();
            });
        });
        
        // Initialize color options
        const colorOptions = document.querySelectorAll('.color-option');
        colorOptions.forEach(option => {
            option.addEventListener('click', () => {
                colorOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                config.colorTheme = option.dataset.color;
                drawAvatar();
            });
        });
        
        // Initialize sliders
        shapeCountSlider.addEventListener('input', () => {
            config.shapeCount = parseInt(shapeCountSlider.value);
            shapeCountValue.textContent = config.shapeCount;
            drawAvatar();
        });
        
        shapeSizeSlider.addEventListener('input', () => {
            config.shapeSize = parseInt(shapeSizeSlider.value);
            shapeSizeValue.textContent = shapeSizeNames[config.shapeSize - 1];
            drawAvatar();
        });
        
        // Initialize checkboxes
        randomColorsCheckbox.addEventListener('change', () => {
            config.randomColors = randomColorsCheckbox.checked;
            drawAvatar();
        });
        
        borderCheckbox.addEventListener('change', () => {
            config.border = borderCheckbox.checked;
            drawAvatar();
        });
        
        // Get random color
        function getRandomColor() {
            if (config.randomColors) {
                const letters = '0123456789ABCDEF';
                let color = '#';
                for (let i = 0; i < 6; i++) {
                    color += letters[Math.floor(Math.random() * 16)];
                }
                return color;
            } else {
                const palette = colorPalettes[config.colorTheme];
                return palette[Math.floor(Math.random() * palette.length)];
            }
        }
        
        // Get background color
        function getBackgroundColor() {
            if (config.randomColors) {
                return getRandomColor();
            } else {
                return colorPalettes[config.colorTheme][0];
            }
        }
        
        // Show toast notification
        function showToast(message) {
            toastMessage.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Draw avatar
        function drawAvatar() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Background
            const bgColor = getBackgroundColor();
            ctx.fillStyle = bgColor;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Circular mask
            ctx.globalCompositeOperation = 'destination-in';
            ctx.beginPath();
            ctx.arc(canvas.width/2, canvas.height/2, canvas.width/2, 0, Math.PI * 2);
            ctx.fill();
            
            // Reset composite operation
            ctx.globalCompositeOperation = 'source-over';
            
            // Calculate size base based on slider
            const sizeBase = 30 + (config.shapeSize * 20);
            
            // Set up clipping path for shapes
            ctx.save();
            ctx.beginPath();
            ctx.arc(canvas.width/2, canvas.height/2, canvas.width/2 - 10, 0, Math.PI * 2);
            ctx.clip();
            
            // Draw random shapes
            for (let i = 0; i < config.shapeCount; i++) {
                // Random position within a smaller radius to prevent edge overflow
                const radius = (canvas.width/2 - 20) * Math.sqrt(Math.random());
                const angle = Math.random() * Math.PI * 2;
                const x = canvas.width/2 + radius * Math.cos(angle);
                const y = canvas.height/2 + radius * Math.sin(angle);
                
                // Random size with variation based on size slider
                const sizeVariation = 0.5 + Math.random();
                const size = sizeBase * sizeVariation;
                
                // Shape color
                ctx.fillStyle = getRandomColor();
                
                // Draw shape based on selected shape type
                if (config.shapeType === 'all') {
                    // Random shape
                    const shapeTypes = ['circle', 'square', 'triangle', 'hexagon', 'star'];
                    const randomShape = shapeTypes[Math.floor(Math.random() * shapeTypes.length)];
                    drawShape(randomShape, x, y, size);
                } else {
                    // Specific shape
                    drawShape(config.shapeType, x, y, size);
                }
            }
            
            // Restore canvas state
            ctx.restore();
            
            // Add border if enabled
            if (config.border) {
                ctx.strokeStyle = '#FFFFFF';
                ctx.lineWidth = 10;
                ctx.beginPath();
                ctx.arc(canvas.width/2, canvas.height/2, canvas.width/2 - 5, 0, Math.PI * 2);
                ctx.stroke();
            }
        }
        
        // Draw specific shape
        function drawShape(shapeType, x, y, size) {
            switch(shapeType) {
                case 'circle':
                    ctx.beginPath();
                    ctx.arc(x, y, size/2, 0, Math.PI * 2);
                    ctx.fill();
                    break;
                    
                case 'square':
                    ctx.save();
                    ctx.translate(x, y);
                    ctx.rotate(Math.random() * Math.PI * 2);
                    ctx.fillRect(-size/2, -size/2, size, size);
                    ctx.restore();
                    break;
                    
                case 'triangle':
                    ctx.beginPath();
                    ctx.save();
                    ctx.translate(x, y);
                    ctx.rotate(Math.random() * Math.PI * 2);
                    ctx.moveTo(0, -size/2);
                    ctx.lineTo(size/2, size/2);
                    ctx.lineTo(-size/2, size/2);
                    ctx.closePath();
                    ctx.fill();
                    ctx.restore();
                    break;
                    
                case 'hexagon':
                    ctx.beginPath();
                    ctx.save();
                    ctx.translate(x, y);
                    ctx.rotate(Math.random() * Math.PI * 2);
                    for (let i = 0; i < 6; i++) {
                        const angle = (Math.PI * 2 * i) / 6;
                        const hx = Math.cos(angle) * (size/2);
                        const hy = Math.sin(angle) * (size/2);
                        if (i === 0) {
                            ctx.moveTo(hx, hy);
                        } else {
                            ctx.lineTo(hx, hy);
                        }
                    }
                    ctx.closePath();
                    ctx.fill();
                    ctx.restore();
                    break;
                    
                case 'star':
                    ctx.beginPath();
                    ctx.save();
                    ctx.translate(x, y);
                    ctx.rotate(Math.random() * Math.PI * 2);
                    const spikes = 5;
                    const outerRadius = size/2;
                    const innerRadius = outerRadius * 0.4;
                    
                    for (let i = 0; i < spikes * 2; i++) {
                        const radius = i % 2 === 0 ? outerRadius : innerRadius;
                        const angle = (Math.PI * i) / spikes;
                        const sx = Math.cos(angle) * radius;
                        const sy = Math.sin(angle) * radius;
                        
                        if (i === 0) {
                            ctx.moveTo(sx, sy);
                        } else {
                            ctx.lineTo(sx, sy);
                        }
                    }
                    ctx.closePath();
                    ctx.fill();
                    ctx.restore();
                    break;
            }
        }
        
        // Download avatar as PNG
        downloadBtn.addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = 'sonet_avatar.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
            
            // Animation feedback
            downloadBtn.classList.add('animate-generate');
            setTimeout(() => {
                downloadBtn.classList.remove('animate-generate');
            }, 500);
            
            showToast('Avatar downloaded!');
        });
        
        // Copy avatar to clipboard
        copyBtn.addEventListener('click', async () => {
            try {
                canvas.toBlob(async blob => {
                    const item = new ClipboardItem({ 'image/png': blob });
                    await navigator.clipboard.write([item]);
                    
                    // Animation feedback
                    copyBtn.classList.add('animate-generate');
                    setTimeout(() => {
                        copyBtn.classList.remove('animate-generate');
                    }, 500);
                    
                    showToast('Copied to clipboard!');
                });
            } catch (err) {
                showToast('Failed to copy: ' + err.message);
            }
        });
        
        // Regenerate avatar
        generateBtn.addEventListener('click', () => {
            drawAvatar();
            
            // Animation feedback
            generateBtn.classList.add('animate-generate');
            setTimeout(() => {
                generateBtn.classList.remove('animate-generate');
            }, 500);
            
            canvas.classList.add('animate-generate');
            setTimeout(() => {
                canvas.classList.remove('animate-generate');
            }, 500);
            
            // Trigger shape option animations
            document.querySelectorAll('.shape-option').forEach((opt, index) => {
                setTimeout(() => {
                    opt.classList.add('animate-generate');
                    setTimeout(() => {
                        opt.classList.remove('animate-generate');
                    }, 300);
                }, index * 50);
            });
        });
        
        // Click canvas to regenerate
        canvas.addEventListener('click', () => {
            drawAvatar();
            
            // Animation feedback
            canvas.classList.add('animate-generate');
            setTimeout(() => {
                canvas.classList.remove('animate-generate');
            }, 500);
        });
        
        // Initialize avatar
        drawAvatar();
    </script>
</body>
</html>